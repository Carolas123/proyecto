const phpCode=document.getElementById('phpCode'),jsCode=document.getElementById('jsCode'),btnDelete=document.getElementById('btnDelete'),btnGenerate=document.getElementById('btnGenerate'),btnCopy=document.getElementById('btnCopy');const esCodigoPhpValido=codigo=>{const phpRegex=/<\?php([\s\S]*?)\?>/,match=phpCode.value.trim().match(phpRegex);if(!match)return false;const codigoPhp=match[1].trim(),validPhpContentRegex=/(\$[a-zA-Z_][a-zA-Z0-9_]*|\bfunction\b|\bclass\b|\becho\b)/;return validPhpContentRegex.test(codigoPhp)};const convertirPhpAJs=()=>{const phpTexto=phpCode.value.trim();if(!esCodigoPhpValido(phpTexto)){Swal.fire({icon:'error',title:'¡Error!',text:'El código PHP ingresado no es válido. Asegúrese de que contenga código PHP estructuralmente válido.'});return}const jsTexto=phpTexto.replace(/<\?php|<\?|\?>/g,'').replace(/echo\s+(.*?);/g,'console.log($1);').replace(/->/g,'.').replace(/class\s+(\w+)\s*\{/g,'class $1 {').replace(/public\s+function\s+(\w+)\((.*?)\)/g,'$1($2)').replace(/private\s+function\s+(\w+)\((.*?)\)/g,'#$1($2)').replace(/function\s+(\w+)\((.*?)\)/g,'$1($2)').replace(/array\((.*?)\)/g,'[$1]').replace(/=>/g,':').replace(/foreach\s*\((.*?)\s+as\s+\$(\w+)\)/g,'for (const $2 of $1)').replace(/define\((['"`])([a-zA-Z_][a-zA-Z0-9_]*)\1,\s*(.*?)\)/g,'const $2 = $3').replace(/if\s*\((.*?)\):/g,'if ($1) {').replace(/endif;/g,'}').replace(/else:/g,'else {').replace(/endforeach;/g,'}').replace(/while\s*\((.*?)\):/g,'while ($1) {').replace(/endwhile;/g,'}').replace(/for\s*\((.*?)\):/g,'for ($1) {').replace(/endfor;/g,'}').replace(/(\$[a-zA-Z_]\w*)/g,(match,variable,offset,text)=>{const insideFunctionParams=text.substring(0,offset).match(/function\s+\w*\s*\([^)]+$/);if(insideFunctionParams)return variable.substring(1);return`let ${variable.substring(1)}`}).replace(/\blet\s+(.*?\(.+?\))/g,'$1').replace(/(\$[\w]+)\s*\.\=\s*(.*?);/g,'$1 += $2;').replace(/(\$[\w]+)\s*\.\s*(.*?);/g,'$1 + $2;').replace(/strlen\((.*?)\)/g,'$1.length').replace(/isset\((.*?)\)/g,'$1 !== undefined').replace(/empty\((.*?)\)/g,'(!$1 || $1.length === 0)').replace(/print\s+(.*?);/g,'console.log($1);').replace(/\$_(GET|POST|SERVER|COOKIE|SESSION|FILES)\['(.*?)'\]/g,'$1["$2"]');jsCode.value=jsTexto.trim()};const limpiarCampos=()=>{phpCode.value='';jsCode.value=''};const copiarTexto=()=>{if(!jsCode.value){Swal.fire({icon:'error',title:'¡Error!',text:'No hay código JavaScript para copiar.'});return}navigator.clipboard.writeText(jsCode.value).then(()=>Swal.fire({icon:'success',title:'¡Copiado!',text:'Código copiado al portapapeles.'})).catch(()=>Swal.fire({icon:'error',title:'¡Error!',text:'Error al copiar el texto.'}))};btnGenerate.addEventListener('click',convertirPhpAJs);btnDelete.addEventListener('click',limpiarCampos);btnCopy.addEventListener('click',copiarTexto);
